"""
    Shortest decompositions are saved in a dictionary using the dimension as key

    Each decomposition is itself a dictionary, with the base "d" and exponent "e",
    so that d^e = -1 mod (2^n-1). Moreover, they have the additional fields "i", "j",
    and for cubics "k", such that d = 2^i + 2^j [+ 2^k]

    quadratic_decompositions contains all possible decompositions using a quadratic
    base for any n when  3 <= n <= 249, and for even n when 250 <= n <= 500

    cubic_decompositions contains all possible decompositions using a cubic base for
    any n 4 <= n <= 100
"""

quadratic_decompositions = {
    3: {'d': 6, 'i': 4, 'j': 2, 'e': 1},
    5: {'d': 6, 'i': 6, 'j': 2, 'e': 3},
    6: {'d': 5, 'i': 2, 'j': 0, 'e': 3},
    7: {'d': 20, 'i': 4, 'j': 2, 'e': 3},
    10: {'d': 17, 'i': 4, 'j': 0, 'e': 15},
    13: {'d': 6144, 'i': 24, 'j': 12, 'e': 35},
    14: {'d': 5, 'i': 2, 'j': 0, 'e': 21},
    15: {'d': 16385, 'i': 14, 'j': 0, 'e': 75},
    17: {'d': 1025, 'i': 10, 'j': 0, 'e': 15},
    19: {'d': 1280, 'i': 10, 'j': 8, 'e': 1971},
    23: {'d': 257, 'i': 8, 'j': 0, 'e': 2231},
    26: {'d': 4097, 'i': 12, 'j': 0, 'e': 455},
    30: {'d': 16385, 'i': 14, 'j': 0, 'e': 75},
    31: {'d': 41943040, 'i': 25, 'j': 23, 'e': 3148803},
    34: {'d': 65, 'i': 6, 'j': 0, 'e': 21845},
    38: {'d': 5, 'i': 2, 'j': 0, 'e': 262143},
    43: {'d': 65, 'i': 6, 'j': 0, 'e': 197737005},
    46: {'d': 257, 'i': 8, 'j': 0, 'e': 135615797},
    51: {'d': 4194305, 'i': 22, 'j': 0, 'e': 30001923},
    59: {'d': 16385, 'i': 14, 'j': 0, 'e': 305327091563275},
    61: {'d': 17592186306560, 'i': 44, 'j': 18, 'e': 60001119157265},
    62: {'d': 65, 'i': 6, 'j': 0, 'e': 357913941},
    65: {'d': 17179869185, 'i': 34, 'j': 0, 'e': 10378224539865},
    67: {'d': 4611686018427387905, 'i': 62, 'j': 0, 'e': 15295807610659665},
    79: {'d': 5, 'i': 2, 'j': 0, 'e': 576294577078301779},
    83: {'d': 5, 'i': 2, 'j': 0, 'e': 1447815352831891227193},
    85: {'d': 16777217, 'i': 24, 'j': 0, 'e': 4760486403166879215},
    86: {'d': 16777217, 'i': 24, 'j': 0, 'e': 963074800615954005},
    89: {'d': 36028797018968064, 'i': 101, 'j': 55, 'e': 40910113657811641602747},
    93: {'d': 72057594037927937, 'i': 56, 'j': 0, 'e': 768614336762478591},
    95: {'d': 72057594037927937, 'i': 56, 'j': 0, 'e': 7354378117756963125},
    97: {'d': 16385, 'i': 14, 'j': 0, 'e': 102089228364235081637527141},
    101: {'d': 77371252455336267181195265, 'i': 86, 'j': 0, 'e': 29053231578384186812775761},
    102: {'d': 1125899906842625, 'i': 50, 'j': 0, 'e': 150009615},
    103: {'d': 257, 'i': 8, 'j': 0, 'e': 2051214562671759462384635289},
    107: {'d': 2535301200456458802993406410816, 'i': 113, 'j': 101, 'e': 252740306587559756061647991103},
    109: {'d': 274877906945, 'i': 38, 'j': 0, 'e': 372154304155285245107563249903},
    122: {'d': 67108865, 'i': 26, 'j': 0, 'e': 128102389400760775},
    127: {'d': 604462914310914214723584, 'i': 179, 'j': 79, 'e': 1310855536160910610133652585758079},
    129: {'d': 4951760157141521099596496897, 'i': 92, 'j': 0, 'e': 2823765177855081036061139801685},
    130: {'d': 18446744073709551617, 'i': 64, 'j': 0, 'e': 24215857259685},
    131: {'d': 5, 'i': 2, 'j': 0, 'e': 1293849303881895298339827404683529321},
    133: {'d': 4294967300, 'i': 32, 'j': 2, 'e': 1434537025023907007468722155447},
    137: {'d': 316912650057057350374175801345, 'i': 98, 'j': 0, 'e': 39741006355730039527321333167397040041},
    139: {'d': 4194305, 'i': 22, 'j': 0, 'e': 470500820596197431946865472270071275},
    149: {'d': 75557863725914323419137, 'i': 76, 'j': 0, 'e': 29933886172524326364132038117944134026225},
    158: {'d': 5, 'i': 2, 'j': 0, 'e': 244970954266474003376937781587214862827},
    170: {'d': 19342813113834066795298817, 'i': 84, 'j': 0, 'e': 4760486403166879215},
    178: {'d': 309485009821345068724781057, 'i': 88, 'j': 0, 'e': 309485009821345068724781055},
    186: {'d': 4951760157141521099596496897, 'i': 92, 'j': 0, 'e': 768614336762478591},
    193: {'d': 4194305, 'i': 22, 'j': 0, 'e': 98663530461341383830748335452104361425235632284093},
    197: {'d': 4951760157141521099596496897, 'i': 92, 'j': 0, 'e': 7964801186880388307257913653061684379988296610445883247},
    202: {'d': 1267650600228229401496703205377, 'i': 100, 'j': 0, 'e': 261479084205457681314981849},
    214: {'d': 81129638414606681695789005144065, 'i': 106, 'j': 0, 'e': 81129638414606681695789005144063},
    215: {'d': 95780971304118053647396689196894323976171195136475137, 'i': 176, 'j': 0, 'e': 93020360839526790260778752860082554444300562835},
    218: {'d': 72057594037927937, 'i': 56, 'j': 0, 'e': 141181269069151218082516205946055362145999877400703033089},
    221: {'d': 1461501637330902918203684832716283019655932542977, 'i': 160, 'j': 0, 'e': 15523294489620748507720878247969260196753011622246391835},
    227: {'d': 5444517870735015415413993718908291383297, 'i': 132, 'j': 0, 'e': 433453594442757625577105337973442512013228328307589470957336495},
    233: {'d': 374144419156711147060143317175368453031918731001857, 'i': 168, 'j': 0, 'e': 567944050773353414033794898281466594135397829708115939516271},
    241: {'d': 4294967297, 'i': 32, 'j': 0, 'e': 916414411031455987244373856003197176202834172185057465573737668369009},
    254: {'d': 316912650057057350374175801345, 'i': 98, 'j': 0, 'e': 9452287970026068429538183539771339207},
    266: {'d': 5444517870735015415413993718908291383297, 'i': 132, 'j': 0, 'e': 81768610426362699425717162860479},
    386: {'d': 365375409332725729550921208179070754913983135745, 'i': 158, 'j': 0, 'e': 76801814905158741664020112896801942496608151956274649913202431243043635696792432287201511},
    454: {'d': 4951760157141521099596496897, 'i': 92, 'j': 0, 'e': 9124559626475867890736657270402774872264872426274661558960377321609207395367855574322900687488881411815680626574534370189145}
}

cubic_decompositions = {
    4: {'d': 14, 'i': 3, 'j': 2, 'k': 1, 'e': 1},
    5: {'d': 26, 'i': 6, 'j': 4, 'k': 3, 'e': 3},
    6: {'d': 41, 'i': 5, 'j': 3, 'k': 0, 'e': 3},
    7: {'d': 28, 'i': 4, 'j': 3, 'k': 2, 'e': 9},
    9: {'d': 138, 'i': 7, 'j': 3, 'k': 1, 'e': 3},
    10: {'d': 161, 'i': 7, 'j': 5, 'k': 0, 'e': 15},
    11: {'d': 11, 'i': 3, 'j': 1, 'k': 0, 'e': 11},
    12: {'d': 194, 'i': 7, 'j': 6, 'k': 1, 'e': 3},
    13: {'d': 266, 'i': 8, 'j': 3, 'k': 1, 'e': 35},
    14: {'d': 137, 'i': 7, 'j': 3, 'k': 0, 'e': 21},
    15: {'d': 8195, 'i': 13, 'j': 1, 'k': 0, 'e': 75},
    17: {'d': 81922, 'i': 18, 'j': 16, 'k': 14, 'e': 257},
    18: {'d': 41, 'i': 5, 'j': 3, 'k': 0, 'e': 9},
    19: {'d': 69633, 'i': 31, 'j': 19, 'k': 16, 'e': 511},
    20: {'d': 2114, 'i': 11, 'j': 6, 'k': 1, 'e': 15},
    21: {'d': 16449, 'i': 14, 'j': 6, 'k': 0, 'e': 21},
    22: {'d': 11, 'i': 3, 'j': 1, 'k': 0, 'e': 341},
    23: {'d': 67, 'i': 6, 'j': 1, 'k': 0, 'e': 11155},
    25: {'d': 37, 'i': 5, 'j': 2, 'k': 0, 'e': 75},
    26: {'d': 40961, 'i': 15, 'j': 13, 'k': 0, 'e': 455},
    28: {'d': 49154, 'i': 15, 'j': 14, 'k': 1, 'e': 21},
    29: {'d': 515, 'i': 9, 'j': 1, 'k': 0, 'e': 4959},
    30: {'d': 163841, 'i': 17, 'j': 15, 'k': 0, 'e': 75},
    31: {'d': 17563648, 'i': 24, 'j': 19, 'k': 18, 'e': 549791},
    33: {'d': 2097157, 'i': 21, 'j': 2, 'k': 0, 'e': 99913},
    34: {'d': 67240448, 'i': 51, 'j': 43, 'k': 26, 'e': 15},
    35: {'d': 259, 'i': 8, 'j': 1, 'k': 0, 'e': 46095},
    37: {'d': 16387, 'i': 14, 'j': 1, 'k': 0, 'e': 19259943},
    38: {'d': 530, 'i': 39, 'j': 9, 'k': 4, 'e': 13797},
    39: {'d': 268435585, 'i': 28, 'j': 7, 'k': 0, 'e': 530985},
    41: {'d': 515, 'i': 9, 'j': 1, 'k': 0, 'e': 3351918797},
    42: {'d': 536903681, 'i': 29, 'j': 15, 'k': 0, 'e': 21},
    43: {'d': 16777345, 'i': 24, 'j': 7, 'k': 0, 'e': 13182467},
    45: {'d': 8589934610, 'i': 33, 'j': 4, 'k': 1, 'e': 19425},
    46: {'d': 8389121, 'i': 23, 'j': 9, 'k': 0, 'e': 2231},
    47: {'d': 1073758209, 'i': 30, 'j': 14, 'k': 0, 'e': 20725825},
    49: {'d': 2147487760, 'i': 31, 'j': 12, 'k': 4, 'e': 4947183927},
    51: {'d': 17592186044425, 'i': 44, 'j': 3, 'k': 0, 'e': 21429945},
    52: {'d': 134234114, 'i': 27, 'j': 14, 'k': 1, 'e': 455},
    53: {'d': 17179869193, 'i': 34, 'j': 3, 'k': 0, 'e': 19266825},
    57: {'d': 274878169089, 'i': 38, 'j': 18, 'k': 0, 'e': 37449},
    59: {'d': 549755814145, 'i': 39, 'j': 8, 'k': 0, 'e': 1001072431355},
    60: {'d': 2147745794, 'i': 31, 'j': 18, 'k': 1, 'e': 75},
    61: {'d': 4644339263209472, 'i': 92, 'j': 52, 'k': 47, 'e': 906361316575},
    62: {'d': 2255098348568576, 'i': 51, 'j': 41, 'k': 40, 'e': 34636833},
    65: {'d': 9007199254742144, 'i': 53, 'j': 10, 'k': 7, 'e': 798324964605},
    67: {'d': 274877907201, 'i': 38, 'j': 8, 'k': 0, 'e': 175813880582295},
    68: {'d': 35433480194, 'i': 35, 'j': 30, 'k': 1, 'e': 21845},
    69: {'d': 281474976972804, 'i': 48, 'j': 18, 'k': 2, 'e': 162518309498281},
    71: {'d': 2251799813701633, 'i': 51, 'j': 14, 'k': 0, 'e': 215254476468345},
    73: {'d': 70368746274817, 'i': 46, 'j': 21, 'k': 0, 'e': 1726845200475585},
    76: {'d': 549755813954, 'i': 39, 'j': 6, 'k': 1, 'e': 262143},
    77: {'d': 17179885569, 'i': 34, 'j': 14, 'k': 0, 'e': 96880607208185493},
    78: {'d': 2097665, 'i': 21, 'j': 9, 'k': 0, 'e': 4350360105},
    79: {'d': 576460752303427585, 'i': 59, 'j': 12, 'k': 0, 'e': 101699043013817961},
    83: {'d': 72057594037927939, 'i': 56, 'j': 1, 'k': 0, 'e': 1447815352831891227193},
    85: {'d': 137443164160, 'i': 37, 'j': 22, 'k': 14, 'e': 280028611950992895},
    86: {'d': 8796093022337, 'i': 43, 'j': 7, 'k': 0, 'e': 197737005},
    89: {'d': 302231454903657293709316, 'i': 104, 'j': 91, 'k': 78, 'e': 1751818468974302033367},
    92: {'d': 140737488356354, 'i': 47, 'j': 10, 'k': 1, 'e': 135615797},
    93: {'d': 4611686019501129729, 'i': 62, 'j': 30, 'k': 0, 'e': 97612893},
    95: {'d': 2199023255561, 'i': 41, 'j': 3, 'k': 0, 'e': 58835024942055705},
    97: {'d': 68719476739, 'i': 36, 'j': 1, 'k': 0, 'e': 102089228364235081637527141}
}