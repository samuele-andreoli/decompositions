"""
    Decompositions are saved in a dictionary
    using the dimension as key:

        {n: (d, e)}

    where the decomposition (d,e) contains the base and exponent, so that
    d^e = -1 mod (2^n-1)

    quadratic_decompositions contains all possible decompositions using
    a quadratic base for 3 <= n <= 241

    cubic_decompositions contains all possible decompositions using a
    cubic base for 4 <= n <= 97
"""

quadratic_decompositions = {
    3: (3, 3),
    5: (3, 15),
    6: (5, 3),
    7: (5, 21),
    10: (17, 15),
    13: (3, 455),
    14: (5, 21),
    15: (3, 75),
    17: (129, 255),
    19: (5, 37449),
    23: (257, 2231),
    26: (4097, 455),
    30: (16385, 75),
    31: (5, 97612893),
    34: (65, 21845),
    38: (5, 262143),
    43: (65, 197737005),
    46: (257, 135615797),
    51: (4194305, 30001923),
    59: (16385, 305327091563275),
    61: (67108865, 3660068268593165),
    62: (65, 357913941),
    65: (2147483649, 10378224539865),
    67: (33, 15295807610659665),
    79: (5, 576294577078301779),
    83: (5, 1447815352831891227193),
    85: (3, 4760486403166879215),
    86: (16777217, 963074800615954005),
    89: (8796093022209, 3641000115545236102644483),
    93: (3, 768614336762478591),
    95: (2097153, 7354378117756963125),
    97: (16385, 102089228364235081637527141),
    101: (32769, 29053231578384186812775761),
    102: (1125899906842625, 150009615),
    103: (257, 2051214562671759462384635289),
    107: (67108865, 758220919762679268184943973309),
    109: (8388609, 372154304155285245107563249903),
    122: (67108865, 128102389400760775),
    127: (134217729, 166478653092435647486973878391276033),
    129: (137438953473, 2823765177855081036061139801685),
    130: (18446744073709551617, 24215857259685),
    131: (5, 1293849303881895298339827404683529321),
    133: (17592186044417, 3555156975059247801118137515673),
    137: (549755813889, 39741006355730039527321333167397040041),
    139: (4194305, 470500820596197431946865472270071275),
    149: (513, 29933886172524326364132038117944134026225),
    158: (5, 244970954266474003376937781587214862827),
    170: (19342813113834066795298817, 4760486403166879215),
    178: (309485009821345068724781057, 309485009821345068724781055),
    186: (4951760157141521099596496897, 768614336762478591),
    193: (4194305, 98663530461341383830748335452104361425235632284093),
    197: (4951760157141521099596496897, 7964801186880388307257913653061684379988296610445883247),
    202: (1267650600228229401496703205377, 261479084205457681314981849),
    214: (81129638414606681695789005144065, 81129638414606681695789005144063),
    215: (549755813889, 93020360839526790260778752860082554444300562835),
    218: (72057594037927937, 141181269069151218082516205946055362145999877400703033089),
    221: (2305843009213693953, 15523294489620748507720878247969260196753011622246391835),
    227: (39614081257132168796771975169, 433453594442757625577105337973442512013228328307589470957336495),
    233: (36893488147419103233, 567944050773353414033794898281466594135397829708115939516271),
    241: (4294967297, 916414411031455987244373856003197176202834172185057465573737668369009)
}

cubic_decompositions = {
    4: (14, 1),
    5: (11, 15),
    6: (41, 3),
    7: (7, 63),
    9: (145, 3),
    10: (161, 15),
    11: (11, 11),
    12: (194, 3),
    13: (6145, 63),
    14: (137, 21),
    15: (8195, 75),
    17: (13, 3855),
    18: (41, 9),
    19: (69633, 511),
    20: (2114, 15),
    21: (16449, 21),
    22: (11, 341),
    23: (67, 11155),
    25: (37, 75),
    26: (40961, 455),
    28: (49154, 21),
    29: (515, 4959),
    30: (163841, 75),
    31: (41, 1649373),
    33: (2097157, 99913),
    34: (133121, 255),
    35: (259, 46095),
    37: (16387, 19259943),
    38: (530, 13797),
    39: (268435585, 530985),
    41: (515, 3351918797),
    42: (536903681, 21),
    43: (16777345, 13182467),
    45: (73729, 19425),
    46: (8389121, 2231),
    47: (1073758209, 20725825),
    49: (134217985, 34630287489),
    51: (17592186044425, 21429945),
    52: (134234114, 455),
    53: (17179869193, 19266825),
    57: (274878169089, 37449),
    59: (549755814145, 1001072431355),
    60: (2147745794, 75),
    61: (70437463654401, 13969218429075),
    62: (8195, 51130563),
    65: (8589934597, 3459408179955),
    67: (274877907201, 175813880582295),
    68: (35433480194, 21845),
    69: (549764202497, 162518309498281),
    71: (2251799813701633, 215254476468345),
    73: (70368746274817, 1726845200475585),
    76: (549755813954, 262143),
    77: (17179885569, 96880607208185493),
    78: (2097665, 4350360105),
    79: (576460752303427585, 101699043013817961),
    83: (72057594037927939, 1447815352831891227193),
    85: (1180591620717411304449, 280028611950992895),
    86: (8796093022337, 197737005),
    89: (67117057, 155911843738712880969663),
    92: (140737488356354, 135615797),
    93: (4611686019501129729, 97612893),
    95: (2199023255561, 58835024942055705),
    97: (68719476739, 102089228364235081637527141)
}